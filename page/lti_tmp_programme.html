<!DOCTYPE html>
<html lang="en">

<head>

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">

	<title>SEMANTICS-2023</title>

	<!-- Bootstrap core CSS -->
	<link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

	<!-- Custom styles for this template -->
	<link href="../css/scrolling-nav.css" rel="stylesheet">

	<link href="../css/style.css" rel="stylesheet">
	<link rel="icon" href="../img/semantics2023-logo-white-browser.ico">

	<link href="../css/lti_tmp_programme.css" rel="stylesheet">

	<!-- Mark down -->
	<script type="module" src="../vendor/zero-md-v2/zero-md.min.js"></script>

	<script src="../vendor/jquery/jquery.min.js"></script>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">

<script src="../js/getconf.js"></script>
<script src="../js/pcontent.js"></script>
<script src="../js/pcsv.js"></script>

</head>

<body id="page-top">

	<div id="nav-placeholder">

	</div>

	<script>
		$(function(){
			$("#nav-placeholder").load("nav.html", function functionName() {apply_conf_onfunc(update_nav, false);});
			//$("#sidecol").load("side.html");
			$("#page-footer").load("footer.html", function functionName() {apply_conf_onfunc(update_footer, false);});
		});
	</script>

	<section>
		<div class="container">
			<div class="row">
				<div class="col-lg-12 mx-auto">

					<div class="row">
						<div class="col-lg-12 mx-auto">
							<zero-md id="main_md" src="../content/programme.md">
								<template> <link href="../css/md-style.css" rel="stylesheet"/> </template>
							</zero-md>

							<div id="buttonGroup" class="btn-group" role="group" aria-label="Button Group">
							  <button id="button1" type="button" data-param="temp_program_21_sep.docx" class="btn btn-light active">21 SEPTEMBER</button>
							  <button id="button2" type="button" data-param="temp_program_22_sep.docx" class="btn btn-light">22 SEPTEMBER</button>
							</div>

						</div>
					</div>

					<div class="row">
						<div class="col-lg-12 mx-auto">

							<div class="row">
								<div id="ks_browser" class="col-lg-12 mx-auto"></div>
							</div>

						</div>
						<!--<div class="col-lg-3 mx-auto"><div id="sidecol" /></div>-->

					</div>

					<!-- <div class="row">
						<div class="col-lg-12 d-flex align-items-center justify-content-center">
							<p>All times are indicated in CEST</p>
						</div>
					</div>

					<div class="row">
						<div class="col-lg-12 mx-auto">
							<zero-md id="secondary_md" src="../content/temp_programme_21_09_2023.md">
								<template> <link href="../css/md-temp-prog-style.css" rel="stylesheet"/> </template>
							</zero-md>
						</div>
					</div> -->

				</div>
				<div class="col-lg-3 mx-auto">
					<div id="sidecol" />
				</div>

			</div>
		</div>
	</section>

	<!-- Footer -->
	<footer id="page-footer"></footer>

	<!-- Footer -->
	<footer id="page-footer"></footer>

	<!-- Bootstrap core JavaScript -->
	<script src="../vendor/jquery/jquery.min.js"></script>
	<script src="../vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

	<!-- Plugin JavaScript -->
	<script src="../vendor/jquery-easing/jquery.easing.min.js"></script>

	<!-- Custom JavaScript for this theme -->
	<script src="../js/scrolling-nav.js"></script>

	<!-- <script src="../js/xlsx.full.min.js"></script>
	<script>

	function handleClick() {
		var prog_md = this.getAttribute('data-param');
		document.getElementById('secondary_md').setAttribute("src","../content/"+prog_md);
	}

	// Attach the event listener
	document.getElementById('button1').addEventListener('click', handleClick);
	document.getElementById('button2').addEventListener('click', handleClick);

	</script> -->

	<script src="../js/mammoth.browser.min.js"></script>
	<script>

		function handleClick() {
				for (var i = 0; i < buttons.length; i++) {
					buttons[i].classList.remove("active");
				}

				event.target.classList.add("active");

				var doc_page = this.getAttribute('data-param');
				//view ks page
				const queryString = window.location.search;
				const urlParams = new URLSearchParams(queryString);
				const page = urlParams.get('page');

			  // Replace 'path/to/document.docx' with the actual path to your DOCX file
			  var docxPath = '../content/'+doc_page;
			  var container = document.getElementById('ks_browser');

			  // Load the DOCX file
			  fetch(docxPath)
			    .then(function(response) {
			      return response.arrayBuffer();
			    })
			    .then(function(arrayBuffer) {
			      var options = {
							arrayBuffer: arrayBuffer,
							styleMap: [
								"b => strong",
			          "p[style-name='Tiltle'] => h1",
								"p[style-name='Table'] => table > thead > tr > th:fresh"
			        ]
						};

			      // Convert DOCX to HTML using Mammoth.js
			      mammoth.convertToHtml(options).then(function(result) {
			        // Display the converted HTML content in the container
			        container.innerHTML = result.value;
			      });
			    })
			    .catch(function(error) {
			      console.error('Error loading DOCX file:', error);
			    });

				//generate ks extra materials (if any)
				//apply_conf_onfunc(build_ks_att, false);
			}

			// handle buttons
			var buttonGroup = document.getElementById("buttonGroup");
			var buttons = buttonGroup.getElementsByTagName("button");


			document.getElementById('button1').addEventListener('click', handleClick);
			document.getElementById('button2').addEventListener('click', handleClick);

			document.getElementById('button1').click();
	</script>


</body>

</html>
